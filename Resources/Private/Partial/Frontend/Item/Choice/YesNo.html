<html
	xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
	data-namespace-typo3-fluid="true"
>

<div class="type-5{f:if(condition: '{item.displayType} == 1', then: ' horizontal')}{f:if(condition: item.styleclass, then: ' {item.styleclass}')}">
	<f:render section="question" arguments="{_all}" />
	<f:render partial="questionSubtext" arguments="{questionSubtext: item.questionSubtext}" />

	<div id="error-container-{item.uid}" class="error-container"></div>
	<f:for each="{item.optionRows}" as="optionRow" iteration="optionRowIterator">
		<f:if condition="{item.displayType} == 0">
			<f:then>
				<select
					name="pbsurvey_{configuration.uid}[{item.uid}][{optionRow.uid}]"
					id="pbsurvey-{configuration.uid}-{item.uid}"
					{f:render(section: 'errorHandling', arguments: '{_all}')}
				>
					<f:for each="{optionRow.options}" as="option">
						<option
							value="{f:if(condition: option.uid, then: option.uid)}"
							{f:if(condition: option.checked, then: ' selected')}
						>
							{option.label}
						</option>
					</f:for>
				</select>
			</f:then>
			<f:else>
				<fieldset id="error-class-{item.uid}">
					<f:for each="{optionRow.options}" as="option" iteration="optionIterator">
						<label>
							<f:if condition="{optionIterator.index} == 0">
								<f:then>
									<input
										type="radio"
										name="pbsurvey_{configuration.uid}[{item.uid}][{optionRow.uid}]"
										value="{option.uid}"
										{f:if(condition: option.checked, then: 'checked')}
										{f:render(section: 'errorHandling', arguments: '{_all}')}
									/>
								</f:then>
								<f:else>
									<input
										type="radio"
										name="pbsurvey_{configuration.uid}[{item.uid}][{optionRow.uid}]"
										value="{option.uid}"
										{f:if(condition: option.checked, then: ' checked')}
									>
								</f:else>
							</f:if>
							{option.label}
						</label>
					</f:for>
				</fieldset>
			</f:else>
		</f:if>
	</f:for>
</div>

<f:section name="question">
	<f:if condition="{item.displayType} == 0">
		<f:then>
			<label class="question" for="pbsurvey-{configuration.uid}-{item.uid}">
				<f:render partial="numberingQuestion" arguments="{_all}" />
				{item.question}
				{f:render(section: 'questionConditions', arguments: '{_all}')}
			</label>
		</f:then>
		<f:else>
			<h2 class="question">
				<f:render partial="numberingQuestion" arguments="{_all}" />
				{item.question}
				{f:render(section: 'questionConditions', arguments: '{_all}')}
			</h2>
		</f:else>
	</f:if>
</f:section>

<f:section name="questionConditions">
	<f:if condition="{item.optionsRequired}">
		<em>
			<f:render partial="translate" arguments="{key: 'item.label.optionsRequired'}" />
		</em>
	</f:if>
</f:section>

<f:section name="errorHandling">
	<f:if condition="{item.optionsRequired}">
		required
		data-parsley-required-message="{f:render(partial: 'translate', arguments: {key: 'item.error.optionsRequired.select.single'})}"
		data-parsley-errors-container="#error-container-{item.uid}"

		<f:if condition="{item.displayType} != 0">
			data-parsley-class-handler="#error-class-{item.uid}"
		</f:if>
	</f:if>
</f:section>

</html>