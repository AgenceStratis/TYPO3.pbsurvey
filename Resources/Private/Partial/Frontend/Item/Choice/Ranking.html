<html
	xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
	data-namespace-typo3-fluid="true"
>

<div class="type-16{f:if(condition: item.styleclass, then: ' {item.styleclass}')}">
	<f:render section="question" arguments="{_all}" />
	<f:render partial="questionSubtext" arguments="{questionSubtext: item.questionSubtext}" />
	<f:render partial="errorContainer" arguments="{_all}" />

	<table id="error-class-{item.uid}" data-pbsurvey-matrix="{item.uid}">
		<thead>
			<tr>
				<td>&nbsp;</td>
				<f:for each="{item.options}" as="option">
					<td>{option.label}</td>
				</f:for>
			</tr>
		</thead>
		<tbody>
			<f:for each="{item.optionRows}" as="optionRow" iteration="optionRowIterator">
				<tr id="error-class-{item.uid}-{optionRow.uid}" class="{f:if(condition: optionRowIterator.isEven, then: 'even', else: 'odd')}">
					<th>{optionRow.label}</th>
					<f:for each="{optionRow.options}" as="option" iteration="optionIterator">
						<td>
							<input
								type="radio"
								name="pbsurvey_{configuration.uid}[{item.uid}][{optionRow.uid}]"
								value="{option.uid}"
								data-pbsurvey-column="pbsurvey-{configuration.uid}-{item.uid}-{option.uid}"
								{f:if(condition: option.checked, then: ' checked')}
								{f:render(section: 'errorHandling', arguments: '{_all}')}
							/>
						</td>
					</f:for>
				</tr>
			</f:for>
		</tbody>
	</table>
</div>

<f:section name="question">
	<h2 class="question">
		<f:render partial="numberingQuestion" arguments="{_all}" />
		{item.question}
		{f:render(section: 'questionConditions', arguments: '{_all}')}
	</h2>
</f:section>

<f:section name="questionConditions">
	<em>
		<f:if condition="{item.optionsRequired}">
			<f:then>
				<f:render partial="translate" arguments="{key: 'item.label.select.row.optionsRequired'}" />
			</f:then>
			<f:else>
				<f:render partial="translate" arguments="{key: 'item.label.select.row'}" />
			</f:else>
		</f:if>
	</em>
</f:section>

<f:section name="errorHandling">
	<f:if condition="{optionRowIterator.index} == 0">
		<f:if condition="{optionIterator.index} == 0">
			data-parsley-validate-if-empty
			data-parsley-matrix-mincheck="[{optionRow.options -> f:count()}, {f:if(condition: item.optionsRequired, then: 'true', else: 'false')}]"
			data-parsley-matrix-mincheck-message="{f:render(partial: 'translate', arguments: {key: 'item.error.matrix.mincheck', printf: {0: '{optionRow.options -> f:count()}'}})}"
			data-parsley-errors-container="#error-container-{item.uid}"
			data-parsley-class-handler="#error-class-{item.uid}"
		</f:if>
	</f:if>
</f:section>

</html>