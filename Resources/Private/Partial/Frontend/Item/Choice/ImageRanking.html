<html
	xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
	data-namespace-typo3-fluid="true"
>

<div class="type-24{f:if(condition: item.imageAlignment, then: ' image-alignment-{item.imageAlignment}')}{f:if(condition: item.styleclass, then: ' {item.styleclass}')}">
	<f:render section="labelHeader" arguments="{_all}" />
	<f:render partial="questionSubtext" arguments="{questionSubtext: item.questionSubtext}" />

	<div id="error-container-{item.uid}"></div>
	<fieldset id="error-class-{item.uid}" data-pbsurvey-matrix="{item.uid}">
		<f:for each="{item.optionRows}" as="optionRow" iteration="optionRowIterator">
			<fieldset class="{f:if(condition: optionRowIterator.isEven, then: 'even', else: 'odd')}">
				<f:image
					src="{optionRow.uid}"
					treatIdAsReference="1"
					maxWidth="{f:if(condition: item.imageWidth, then: item.imageWidth)}"
					maxHeight="{f:if(condition: item.imageHeight, then: item.imageHeight)}"
				/>
				<f:for each="{optionRow.options}" as="option" iteration="optionIterator">
					<input
						type="radio"
						name="pbsurvey_{configuration.uid}[{item.uid}][o][{option.uid}][r]"
						id="pbsurvey-{configuration.uid}-{item.uid}-{optionRow.uid}-{option.uid}"
						value="{optionRow.uid}"
						data-pbsurvey-row="pbsurvey-{configuration.uid}-{item.uid}-{optionRow.uid}"
						{f:if(condition: option.checked, then: 'checked')}
						{f:render(section: 'optionsRequired', arguments: '{_all}')}
					/>
					<label for="pbsurvey-{configuration.uid}-{item.uid}-{optionRow.uid}-{option.uid}">
						{option.label}
					</label>
				</f:for>
			</fieldset>
		</f:for>
	</fieldset>
</div>

<f:section name="labelHeader">
	<h2 class="label">
		{item.question}
		<f:if condition="{item.optionsRequired}">
			<f:then>
				<em>
					<f:render partial="translate" arguments="{key: 'item.label.imageRating.optionsRequired'}" />
				</em>
			</f:then>
			<f:else>
				<em>
					<f:render partial="translate" arguments="{key: 'item.label.imageRating'}" />
				</em>
			</f:else>
		</f:if>
	</h2>
</f:section>

<f:section name="optionsRequired">
	<f:if condition="{optionRowIterator.index} == 0">
		<f:if condition="{item.optionsRequired}">
			<f:then>
				required
				data-parsley-required-message="{f:render(partial: 'translate', arguments: {key: 'item.error.optionsRequired.select.ranking', printf: {0: option.uid}})}"
				data-parsley-errors-container="#error-container-{item.uid}"
				data-parsley-class-handler="#error-class-{item.uid}"
			</f:then>
			<f:else>
				<f:if condition="{optionIterator.index} == 0">
					data-parsley-validate-if-empty
					data-parsley-matrix-mincheck="{optionRow.options -> f:count()}"
					data-parsley-matrix-mincheck-message="{f:render(partial: 'translate', arguments: {key: 'item.error.matrix.mincheck', printf: {0: '{optionRow.options -> f:count()}'}})}"
					data-parsley-errors-container="#error-container-{item.uid}"
					data-parsley-class-handler="#error-class-{item.uid}"
				</f:if>
			</f:else>
		</f:if>
	</f:if>
</f:section>

</html>