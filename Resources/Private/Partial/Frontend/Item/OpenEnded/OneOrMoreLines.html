<html
	xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
	data-namespace-typo3-fluid="true"
>

<div class="type-7{f:if(condition: item.styleclass, then: ' {item.styleclass}')}">
	<f:render section="question" arguments="{_all}" />
	<f:render partial="questionSubtext" arguments="{questionSubtext: item.questionSubtext}" />
	<f:render partial="errorContainer" arguments="{_all}" />

	<fieldset id="error-class-{item.uid}" data-pbsurvey-matrix="{item.uid}">
		<f:for each="{item.optionRows}" as="optionRow" iteration="optionRowIterator">
			<f:for each="{optionRow.options}" as="option" iteration="optionIterator">
				<label>
					<span>
						{option.label}
					</span>
					<input
						type="text"
						name="pbsurvey_{configuration.uid}[{item.uid}][{optionRow.uid}][{option.uid}]"
						value="{option.value}"
						{f:render(section: 'errorHandling', arguments: '{_all}')}
					/>
				</label>
			</f:for>
		</f:for>
	</fieldset>
</div>

<f:section name="question">
	<h2 class="question">
		<f:render partial="numberingQuestion" arguments="{_all}" />
		{item.question}
		{f:render(section: 'questionConditions', arguments: '{_all}')}
	</h2>
</f:section>

<f:section name="questionConditions">
	<f:if condition="{item.optionsRequired}">
		<f:then>
			<em>
				<f:if condition="{item.optionsResponsesMinimum} > 1">
					<f:then>
						<f:if condition="{item.optionsResponsesMaximum}">
							<f:then>
								<f:render partial="translate" arguments="{key: 'item.label.enter.range.optionsRequired', printf: '{0: item.optionsResponsesMinimum, 1: item.optionsResponsesMaximum}'}" />
							</f:then>
							<f:else>
								<f:render partial="translate" arguments="{key: 'item.label.enter.minimum.optionsRequired', printf: '{0: item.optionsResponsesMinimum}'}" />
							</f:else>
						</f:if>
					</f:then>
					<f:else>
						<f:if condition="{item.optionsResponsesMaximum}">
							<f:then>
								<f:render partial="translate" arguments="{key: 'item.label.enter.maximum.optionsRequired', printf: '{0: item.optionsResponsesMaximum}'}" />
							</f:then>
							<f:else>
								<f:render partial="translate" arguments="{key: 'item.label.enter.minimum.optionsRequired', printf: '{0: 1}'}" />
							</f:else>
						</f:if>
					</f:else>
				</f:if>
			</em>
		</f:then>
		<f:else>
			<f:if condition="{item.optionsResponsesMinimum}">
				<f:then>
					<em>
						<f:if condition="{item.optionsResponsesMaximum}">
							<f:then>
								<f:render partial="translate" arguments="{key: 'item.label.enter.range', printf: '{0: item.optionsResponsesMinimum, 1: item.optionsResponsesMaximum}'}" />
							</f:then>
							<f:else>
								<f:render partial="translate" arguments="{key: 'item.label.enter.minimum', printf: '{0: item.optionsResponsesMinimum}'}" />
							</f:else>
						</f:if>
					</em>
				</f:then>
				<f:else>
					<em>
						<f:if condition="{item.optionsResponsesMaximum}">
							<f:then>
								<f:render partial="translate" arguments="{key: 'item.label.enter.maximum', printf: '{0: item.optionsResponsesMaximum}'}" />
							</f:then>`
						</f:if>
					</em>
				</f:else>
			</f:if>
		</f:else>
	</f:if>
</f:section>

<f:section name="errorHandling">
	<f:if condition="{optionRowIterator.index} == 0">
		<f:if condition="{optionIterator.index} == 0">
			data-parsley-validate-if-empty
			data-parsley-trigger-after-failure="null"
			data-parsley-errors-container="#error-container-{item.uid}"
			data-parsley-class-handler="#error-class-{item.uid}"
			<f:if condition="{item.optionsRequired}">
				<f:then>
					<f:if condition="{item.optionsResponsesMinimum} > 1">
						<f:then>
							<f:if condition="{item.optionsResponsesMaximum}">
								<f:then>
									data-parsley-text-range="[{item.optionsResponsesMinimum}, {item.optionsResponsesMaximum}, true]"
									data-parsley-text-range-message="{f:render(partial: 'translate', arguments: {key: 'item.error.enter.range', printf: '{0: item.optionsResponsesMinimum, 1: item.optionsResponsesMaximum}'})}"
								</f:then>
								<f:else>
									data-parsley-text-minimum="[{item.optionsResponsesMinimum}, true]"
									data-parsley-text-minimum-message="{f:render(partial: 'translate', arguments: {key: 'item.error.enter.minimum', printf: '{0: item.optionsResponsesMinimum}'})}"
								</f:else>
							</f:if>
						</f:then>
						<f:else>
							<f:if condition="{item.optionsResponsesMaximum}">
								<f:then>
									data-parsley-text-range="[1, {item.optionsResponsesMaximum}, true]"
									data-parsley-text-range-message="{f:render(partial: 'translate', arguments: {key: 'item.error.enter.range', printf: '{0: 1, 1: item.optionsResponsesMaximum}'})}"
								</f:then>
								<f:else>
									data-parsley-text-minimum="[1, true]"
									data-parsley-text-minimum-message="{f:render(partial: 'translate', arguments: {key: 'item.error.enter.minimum', printf: '{0: 1}'})}"
								</f:else>
							</f:if>
						</f:else>
					</f:if>
				</f:then>
				<f:else>
					<f:if condition="{item.optionsResponsesMinimum}">
						<f:then>
							<f:if condition="{item.optionsResponsesMaximum}">
								<f:then>
									data-parsley-text-range="[{item.optionsResponsesMinimum}, {item.optionsResponsesMaximum}, false]"
									data-parsley-text-range-message="{f:render(partial: 'translate', arguments: {key: 'item.error.enter.range', printf: '{0: item.optionsResponsesMinimum, 1: item.optionsResponsesMaximum}'})}"
								</f:then>
								<f:else>
									data-parsley-text-minimum="[{item.optionsResponsesMinimum}, false]"
									data-parsley-text-minimum-message="{f:render(partial: 'translate', arguments: {key: 'item.error.enter.minimum', printf: '{0: item.optionsResponsesMinimum}'})}"
								</f:else>
							</f:if>
						</f:then>
						<f:else>
								<f:if condition="{item.optionsResponsesMaximum}">
									<f:then>
										data-parsley-text-maximum="{item.optionsResponsesMaximum}"
										data-parsley-text-maximum-message="{f:render(partial: 'translate', arguments: {key: 'item.error.enter.maximum', printf: '{0: item.optionsResponsesMaximum}'})}"
									</f:then>`
								</f:if>
						</f:else>
					</f:if>
				</f:else>
			</f:if>
		</f:if>
	</f:if>
	<f:if condition="{item.lengthMaximum}">
		maxlength="{item.lengthMaximum}"
		data-parsley-maxlength-message="{f:render(partial: 'translate', arguments: {key: 'item.error.length', printf: '{0: item.lengthMaximum}'})}"
	</f:if>
</f:section>

</html>